import cv2
import numpy as np
import requests

while True:
    try:
        # Se realiza una petición GET a la URL del servidor
        images = requests.get("http://ip:puerto/shot.jpg")
        
        # Verifica si la solicitud fue exitosa
        if images.status_code != 200:
            print(f"Error: No se pudo obtener la imagen. Código de estado: {images.status_code}")
            break
        
        # Se decodifica el contenido de la respuesta en un objeto numpy
        video = np.array(bytearray(images.content), dtype=np.uint8)
        
        # Se decodifica el objeto numpy en un objeto cv2
        render = cv2.imdecode(video, -1)
        
        # Verifica si la imagen se decodificó correctamente
        if render is None:
            print("Error: No se pudo decodificar la imagen.")
            break
        
        # Muestra la imagen
        cv2.imshow('frame', render)
        
        # Si se presiona la tecla 'q' se cierra la ventana
        if cv2.waitKey(1) & 0xFF == ord('q'):
            break
    except Exception as e:
        print(f"Error inesperado: {e}")
        break

# Libera los recursos
cv2.destroyAllWindows()
    
